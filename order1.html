<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unidessert有你甜點|購物車</title>
    <link href="https://api.fontshare.com/v2/css?f[]=gambetta@400,1,300,600,701,2,501,401,301,601,500,700&display=swap"
        rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC&family=Satisfy&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../media/css/bootstrap.css">
    <script src="../media/js/jquery-3.7.0.min.js"></script>
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.theme.default.min.css"
        integrity="sha512-sMXtMNL1zRzolHYKEujM2AqCLUR9F2C4/05cdbxjjLSRvMQIciEPCQZo++nk7go3BtSuK9kfa/s+a4f4i5pLkw=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.min.css"
        integrity="sha512-tS3S5qG0BlhnQROyJXvNjeEM4UpMXHrQfTGmbQ1gKmelCxlSEBUaxhRBj/EFTzpbP4RVSrpEikbmdJobCvhE3g=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js"
        integrity="sha512-bPs7Ae6pVvhOSiIcyUClR7/q2OAsRiovw4vAkX+zJbw3ShAeeqezq50RIIcIURq7Oa20rW2n2q+fyXBNcU9lrw=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <link rel="stylesheet" href="../media/css/order1.css" type="text/css">
</head>

<body>
    <div class="headerPage"></div>
    <picture>
        <source media="(max-width: 768px)" srcset="../media/pic/cart/order1.png">
        <img class="statement" src="../media/pic/cart/order1(2x).png">
    </picture>

    <div class="mycontainer container">
        <div class="table">
            <div class="table-header row">
                <div class="table-cell col-3">商品明细</div>
                <div class="table-cell col-3">規格</div>
                <div class="table-cell col-2">數量</div>
                <div class="table-cell col-2">價格</div>
                <div class="table-cell col-2">小計</div>
            </div>
            <div class="table-row table-row1 order row">
                <div class="table-cell col-3">
                    <div class="product-info">
                        <img src="../media/pic/product/product_info1.webp" width="150px" alt="Product 1">
                        <p class="product-name">波多爾可麗露 4入禮盒</p>
                    </div>
                </div>
                <div class="table-cell item col-3">
                    <li>大小 : 4格</li>
                    <li>紙盒 : 粉色</li>
                    <li>紙袋：粉色</li>
                    <li>緞帶：黃色</li>
                    <li>卡片內容:親愛的xxx</li>
                </div>
                <div class="table-cell item col-2 amount">
                    <button class="subtractBtn">-</button>
                    <span class="quantity">1</span>
                    <button class="addBtn">+</button>
                </div>
                <div class="table-cell item col-2 price">$410</div>
                <div class="table-cell item col-1 price-total">$410</div>
                <div class="table-cell item col-1">
                    <span class="delete-btn" onclick="deleteOrder(this)">X</span>
                </div>
            </div>
            <div class="table-row table-row1 order row">
                <div class="table-cell col-3">
                    <div class="product-info">
                        <img src="../media/pic/product/product_info6.webp" width="150px" alt="Product 2">
                        <p class="product-name">柚香碧螺春達克瓦茲</p>
                    </div>
                </div>
                <div class="table-cell item col-3">無</div>
                <div class="table-cell item col-2 amount">
                    <button class="subtractBtn">-</button>
                    <span class="quantity">1</span>
                    <button class="addBtn">+</button>
                </div>
                <div class="table-cell item col-2 price">$500</div>
                <div class="table-cell item col-1 price-total">$500</div>
                <div class="table-cell item col-1">
                    <span class="delete-btn" onclick="deleteOrder(this)">X</span>
                </div>
            </div>

            <div class="table-footer ">
                <div class="table-row table-row1 row">
                    <div class="table-cell col-3"></div>
                    <div class="table-cell col-3"></div>
                    <div class="table-cell col-2"></div>
                    <div class="table-cell item col-2">總計商品數：</div>
                    <div class="table-cell item col-2 product-amount">2件</div>
                </div>
                <div class="table-row table-row1 row">
                    <div class="table-cell col-3"></div>
                    <div class="table-cell col-3"></div>
                    <div class="table-cell col-2"></div>
                    <div class="table-cell item col-2">商品金額：</div>
                    <div class="table-cell item col-2 product-total">$910</div>
                </div>
                <div class="table-row table-row1 row">
                    <div class="table-cell col-3"></div>
                    <div class="table-cell col-3"></div>
                    <div class="table-cell col-2"></div>
                    <div class="table-cell item col-2">運費：</div>
                    <div class="table-cell item col-2 deliver-fee">$80</div>
                </div>
                <div class="table-row table-row1 row">
                    <div class="table-cell col-3"></div>
                    <div class="table-cell col-3"></div>
                    <div class="table-cell col-2"></div>
                    <div class="table-cell item col-2">訂單總額：</div>
                    <div class="table-cell item col-2 cash-total">$990</div>
                </div>
                <div class="table-row row pay">
                    <div class="table-cell col-3"></div>
                    <div class="table-cell col-3"></div>
                    <div class="table-cell col-2"></div>
                    <div class="table-cell item col-2"></div>
                    <div class="table-cell item col-2">
                        <a href="./order2.html"><input class="checkout" type="button" value="結帳"></input></a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <hr>
    <div class="mycontainer container">
        <div class="row">
            <p class="hot">熱門商品推薦</p>
            <div class="owl-carousel owl-theme">
                <div class=" item">
                    <img src="../media/pic/product/product_info1.webp" class="responsive-image" alt="...">
                    <p class="intro">布朗尼禮盒</p>
                </div>
                <div class=" item">
                    <img src="../media/pic/product/product_info1.webp" class="responsive-image" alt="...">
                    <p class="intro">布朗尼禮盒</p>
                </div>
                <div class=" item">
                    <img src="../media/pic/product/product_info1.webp" class="responsive-image" alt="...">
                    <p class="intro">布朗尼禮盒</p>
                </div>
                <div class=" item">
                    <img src="../media/pic/product/product_info1.webp" class="responsive-image" alt="...">
                    <p class="intro">布朗尼禮盒</p>
                </div>
                <div class=" item">
                    <img src="../media/pic/product/product_info1.webp" class="responsive-image" alt="...">
                    <p class="intro">布朗尼禮盒</p>
                </div>
            </div>
        </div>
    </div>


    <div class="footerPage"> </div>


    <script>
        $(".headerPage").load("./nav.html");
        $(".footerPage").load("./footer.html");


        //商品數量更新js
        const subtractBtns = document.querySelectorAll('.subtractBtn');
        const addBtns = document.querySelectorAll('.addBtn');
        const quantityElements = document.querySelectorAll('.quantity');
        const productAmountElement = document.querySelector('.product-amount');
        const priceElements = document.querySelectorAll('.price');
        const productTotalElement = document.querySelector('.product-total');
        const priceTotalElements = document.querySelectorAll('.price-total');
        const deliverFeeElement = document.querySelector('.deliver-fee');
        const cashTotalElement = document.querySelector('.cash-total');

        subtractBtns.forEach((subtractBtn, index) => {
            subtractBtn.addEventListener('click', function () {
                updateQuantity('subtract', 1, index);
                updateProductAmount();
                updatePriceTotal(index);
                updateCashTotal();
            });
        });

        addBtns.forEach((addBtn, index) => {
            addBtn.addEventListener('click', function () {
                updateQuantity('add', 1, index);
                updateProductAmount();
                updatePriceTotal(index);
                updateCashTotal();
            });
        });


        function updateQuantity(action, minValue, index) {
            let quantity = Number(quantityElements[index].textContent);

            if (action === 'add') {
                quantity++;
            } else if (action === 'subtract') {
                if (quantity > minValue) {
                    quantity--;
                } else {
                    quantity = minValue;
                }
            }
            quantityElements[index].textContent = quantity;
        };

        function deleteOrder(button) {
            const row = button.closest('.order');
            row.remove();
            updateProductAmount();
            updatePriceTotal();
            updateProductTotal();
            updateCashTotal();
        }


        function updateProductAmount() {
            const orderRows = document.querySelectorAll('.order');
            const productAmountElement = document.querySelector('.product-amount');
            let productAmount = 0;

            orderRows.forEach((row) => {
                const quantityElement = row.querySelector('.quantity');
                const quantity = Number(quantityElement.textContent);
                productAmount += quantity;
            });

            productAmountElement.textContent = productAmount + '件';
        }

        function updatePriceTotal() {
            priceTotalElements.forEach((priceTotalElement, index) => {
                console.log(quantityElements);
                const quantity = Number(quantityElements[index].textContent);
                const price = Number(priceElements[index].innerText.slice(1));
                console.log(priceElements[index].innerText);
                const priceTotal = quantity * price;
                priceTotalElement.innerText = '$' + priceTotal;
            });

            updateProductTotal(); // 在更新價格總和時，同時更新產品總額
        }

        function updateProductTotal() {
            let productTotal = 0;

            priceTotalElements.forEach((priceTotalElement) => {
                const priceTotal = Number(priceTotalElement.textContent.slice(1));
                productTotal += priceTotal;
            });

            productTotalElement.textContent = '$' + productTotal;
            updateCashTotal(); // 在更新產品總額時，同時更新現金總額
        }


        function updateCashTotal() {
            const productTotal = Number(productTotalElement.textContent.slice(1));
            const deliverFee = Number(deliverFeeElement.textContent.slice(1));
            const cashTotal = productTotal + deliverFee;

            cashTotalElement.textContent = '$' + cashTotal;
        }


        //熱門商品循環撥放
        $(".owl-carousel").owlCarousel({
            loop: true, // 循環播放
            margin: 10, // 外距 10px
            nav: false,
            autoplay: true, // 自動撥放
            autoplayTimeout: 3000, // 自動撥放間隔時間（以毫秒為單位）
            navContainer: '.owl-nav', // 指定控制按鈕的容器元素

            responsive: {
                0: {
                    items: 1 // 螢幕大小為 0~600 顯示 1 個項目
                },
                600: {
                    items: 3 // 螢幕大小為 600~1000 顯示 3 個項目
                },
                1000: {
                    items: 5 // 螢幕大小為 1000 以上 顯示 5 個項目
                }
            }
        });


    </script>
</body>

</html>